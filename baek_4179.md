# Python

## baek 4179 불! 골드4

https://www.acmicpc.net/problem/4179



> python3 2984ms



* 문제

  > 지훈이는 미로에서 일을 한다. 지훈이를 미로에서 탈출하도록 도와주자!
  >
  > 미로에서의 지훈이의 위치와 불이 붙은 위치를 감안해서 지훈이가 불에 타기전에 탈출할 수 있는지의 여부, 그리고 얼마나 빨리 탈출할 수 있는지를 결정해야한다.
  >
  > 지훈이와 불은 매 분마다 한칸씩 수평또는 수직으로(비스듬하게 이동하지 않는다) 이동한다. 
  > 
  > 불은 각 지점에서 네 방향으로 확산된다. 
  > 
  > 지훈이는 미로의 가장자리에 접한 공간에서 탈출할 수 있다. 
  > 
  > 지훈이와 불은 벽이 있는 공간은 통과하지 못한다.
  
* 입력

  > 입력의 첫째 줄에는 공백으로 구분된 두 정수 R과 C가 주어진다. 단, 1 ≤ R, C ≤ 1000 이다. R은 미로 행의 개수, C는 열의 개수이다.
  >
  > 다음 입력으로 R줄동안 각각의 미로 행이 주어진다.
  >
  >  각각의 문자들은 다음을 뜻한다.
  >
  > - \#: 벽
  > - .: 지나갈 수 있는 공간
  > - J: 지훈이의 미로에서의 초기위치 (지나갈 수 있는 공간)
  > - F: 불이 난 공간
  >
  > J는 입력에서 하나만 주어진다.
  >
  > ```bash
  > 4 4
  > ####
  > #JF#
  > #..#
  > #..#
  > ```

* 출력

  > 지훈이가 불이 도달하기 전에 미로를 탈출 할 수 없는 경우 IMPOSSIBLE 을 출력한다.
  >
  > 지훈이가 미로를 탈출할 수 있는 경우에는 가장 빠른 탈출시간을 출력한다. 
  > 
  > ```bash
  > 3
  > ```



```python
## 로직 설명 ##
# 1. 지훈이 있는 좌표와 불이 있는 좌표를 queue에 각각 담아 줍니다.
# 2. 1초 씩 시간이 증가할 때마다 불이 먼저 움직이는 걸로 합니다.
# 2-1. 지훈이가 먼저 움직였을 경우 뒤늦게 불 붙는 경우도 생기기 때문입니다.
# 3. 불을 4방향으로 증가해 줍니다.
# 4. 지훈 큐에는 지도에 있는 곳, 불이 없는 곳, 벽이 없는 곳, 방문하지 않은 곳만을 넣어줍니다.
# 4-1. 만약 지도에 없는 곳을 방문했을 경우 도착이므로 반복문을 빠져 나와 결과값을 출력합니다.


from collections import deque
import sys
input = sys.stdin.readline

def bfs(fireidx): # bfs 함수 진행, fireidx는 시간에 따라 어떤 불이 번질 지의 인덱스
    while jihun: # 지훈이 움직일 방향이 존재하는 동안에
        currentRow, currentCol, t = jihun.popleft() # 지훈 현재 위치와 현재 시간을 pop하고
        if not t in timeList: # 현재 시간에 번진 불이 없다면
            timeList.append(t) # 번진 불 시간 리스트에 시간을 추가해 주고,
            for i in range(fireidx, len(fire)): # 지금 시간에 퍼질 수 있는 불 진행.
                cfr, cfc = fire[i][0], fire[i][1] # 현재 불의 위치
                fireidx += 1 # 이 반복문이 끝나면 지금 새로 번진 불의 위치부터 반복 시작
                for j in range(4): # 4방향으로 불이 번지고
                    nfr, nfc = cfr + dr[j], cfc + dc[j]
                    if 0 <= nfr < r and 0 <= nfc < c and arr[nfr][nfc] != '#' \
                            and visited[nfr][nfc] == False: # 벽이 아니고 지도상에 존재한다면
                        visited[nfr][nfc] = True # 방문표시로 지훈이가 못가게 막고
                        fire.append([nfr, nfc]) # 불 큐에 넣어줌
                    else: # 그게 아니라면
                        continue # 진행 ㄴㄴ
        for i in range(4): # 이제 지훈이 4방향으로 이동
            nr = currentRow + dr[i]
            nc = currentCol + dc[i]
            if 0 <= nr < r and 0 <= nc < c: # 지도 상에 존재한다면,
                if visited[nr][nc] == False and arr[nr][nc] == '.' : # 방문도 안했고, 갈 수 있다면,
                    visited[nr][nc] = True # 방문표시
                    jihun.append([nr, nc, t + 1]) # 움직인 위치와 시간을 더해줌
                else: continue # 아니라면 다음 방향으로 이동하고
            else: # 지도 밖으로 벗어났다면
                print(t + 1) # 답 출력
                exit() # 끝


dr = [-1, 1, 0, 0]
dc = [0, 0, -1, 1]

r, c = map(int, input().split())
arr = []
t, fire, jihun, visited = 0, [], deque([]), [[False] * c for _ in range(r)]
for i in range(r):
    a = list(input().strip())
    arr.append(a)
    for j in range(c):
        if a[j] == "J":
            jihun.append([i, j, 0])
        elif a[j] == "F":
            fire.append([i, j])

timeList, result, fireidx = [], 'IMPOSSIBLE', 0
bfs(fireidx)

print(result)

'''
4 4
####
#JF#
#..#
#..#

3

4 4
####
#JF#
#..#
####
IMPOSSIBLE

2 2
J#
.F
1

5 5
##.##
#...#
#FJ.#
#...#
#####
3

//1
3 4
####
#FJ.
####
2
//
//1
6 7
###.###
#F#.#F#
#.....#
#.....#
#..J..#
#######
5
//
//
//1
4 7
###.###
#....F#
#J....#
.######
IMPOSSIBLE
//
//1
5 5
.....
.FFF.
.FJF.
.FFF.
.....
IMPOSSIBLE
//
//1
3 3
###
#J#
###
IMPOSSIBLE

3 3
###
#J.
#.F
IMPOSSIBLE

10 10
#........#
#........#
#........#
#........#
#...J....#
#........#
#........#
#........#
#........#
FFFFFFFFFF
5
0:00:00.001993
0:00:00.000999


100 100
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
...............................................J....................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
25
0:00:15.980667
0:00:01.638615
0:00:00.019942

'''
```

> 계속 시간 초과 났던 이유는 현재 불이 있는 인덱스에 지금 새로 번질 불의 인덱스가 있다면 안넣는다는 걸 표현하기 위해
>
> for not [nfr, nfc] in fire 이런식으로 표현했는데, 
>
> 생각해보니 이런식이로 리스트에 현재 인덱스를 찾는 것 조차 완탐을 하는 것이라는 생각이 들었다. 그러다 보니 당연히 시간초과 날 수 밖에,,
>
> 나는 for not ~~ in ~~: 이거를 약간 신기하게 생각해서 쓰려고 했지만, 오히려 많은 시간을 소모하므로 쓰지 않는 게 낫겠다.
>
> .
>
> 아 그리고 하나 더 알아낸 건 bfs와 pop의 사용법인데,
>
> 이렇게 최단 거리를 갈 때 bfs를 사용하며 (모든 노드를 방문할 필요가 없을 경우) pop(0) 을 할 경우, 최단 시간을 찾는 것이다. 
>
> pop()을 할 경우, 단순히 도착지점에 도착할 수 있는지의 여부만 확인 하는 것이다.



* 모범답안

  ```python
  2576
  
  from collections import deque
  import sys
  input = sys.stdin.readline
  def bfs():
      global q, f
      while q:
          temp = deque()
          while q:
              x, y = q.popleft()
              if (x == r - 1 or y == c - 1 or x == 0 or y == 0) and s[x][y] != "F": return s[x][y] + 1
              for i in range(4):
                  nx = x + dx[i]
                  ny = y + dy[i]
                  if 0 <= nx < r and 0 <= ny < c and s[nx][ny] == "." and s[x][y] != "F":
                      temp.append([nx, ny])
                      s[nx][ny] = s[x][y] + 1
          q = temp
          if not q: break
          temp = deque()
          while f:
              x, y = f.popleft()
              for i in range(4):
                  nx = x + dx[i]
                  ny = y + dy[i]
                  if 0 <= nx < r and 0 <= ny < c and visit[nx][ny] == 0 and s[nx][ny] != "#":
                      temp.append([nx, ny])
                      visit[nx][ny] = 1
                      s[nx][ny] = "F"
          f = temp
  dx = [1, -1, 0, 0]
  dy = [0, 0, -1, 1]
  r, c = map(int, input().split())
  s = []
  q = deque()
  f = deque()
  visit = [[0] * c for i in range(r)]
  for i in range(r):
      a = list(input().strip())
      s.append(a)
      for j in range(c):
          if a[j] == "J":
              q.append([i, j])
              s[i][j] = 0
          elif a[j] == "F":
              f.append([i, j])
              visit[i][j] = 1
  result = bfs()
  print(result if result != None else "IMPOSSIBLE")
  ```
  
  > 입력 받는 부분을 배워야 한다고 생각한다.
  >
  > ```python
  > import sys
  > input = sys.stdin.readline
  > s = []
  > for i in range(r):
  >     a = list(input().strip())
  >     s.append(a)
  >     for j in range(c):
  >         if a[j] == "J":
  >             q.append([i, j])
  >             s[i][j] = 0
  >         elif a[j] == "F":
  >             f.append([i, j])
  >             visit[i][j] = 1
  > ```
>
  > for문을 돌면서 임시 변수 a로 한 줄 한 줄 list를 입력받는다.
  >
  > split()을 쓰지 않고 strip()을 썼다.
  >
  > 한 줄 씩 입력 받으며 지도상에 append 한다.
  >
  > 그 중 a를 돌면서 지훈이가 있을 경우 지훈 위치에 넣고
  >
  > 불이 있을 경우 불 위치에 넣는다.

